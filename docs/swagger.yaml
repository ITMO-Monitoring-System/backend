basePath: /
definitions:
  lecture.StartLectureRequest:
    properties:
      lecture_id:
        type: integer
      queue:
        type: string
    type: object
  lecture.StopLectureRequest:
    properties:
      lecture_id:
        type: integer
    type: object
  response.ErrorResponse:
    properties:
      error:
        type: string
    type: object
  user.AddUserRequest:
    properties:
      isu:
        type: string
      last_name:
        type: string
      name:
        type: string
      patronymic:
        type: string
    required:
    - isu
    - last_name
    - name
    type: object
info:
  contact: {}
  description: Backend for lecture monitoring via RabbitMQ and WebSocket
  title: Monitoring Backend API
  version: "1.0"
paths:
  /api/lecture/start:
    post:
      consumes:
      - application/json
      description: Запускает обработку очереди RabbitMQ для лекции
      parameters:
      - description: Lecture and RabbitMQ queue
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/lecture.StartLectureRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Consumer already running
          schema:
            type: string
        "202":
          description: Consumer started
          schema:
            type: string
        "400":
          description: Invalid request body
          schema:
            type: string
      summary: Start lecture processing
      tags:
      - lecture
  /api/lecture/stop:
    post:
      consumes:
      - application/json
      description: Stops RabbitMQ consumer and WebSocket broadcasting for the specified
        lecture.
      parameters:
      - description: Lecture identifier
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/lecture.StopLectureRequest'
      produces:
      - application/json
      responses:
        "200":
          description: ok
          schema:
            type: string
        "400":
          description: Invalid request payload
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Lecture not found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Stop lecture processing
      tags:
      - lecture
  /health:
    get:
      description: Проверка доступности сервиса
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            type: string
      summary: Health check
      tags:
      - system
  /users:
    post:
      consumes:
      - application/json
      description: Создаёт нового пользователя с ISU, именем, фамилией и факультативным
        отчеством.
      parameters:
      - description: Пользователь для добавления
        in: body
        name: user
        required: true
        schema:
          $ref: '#/definitions/user.AddUserRequest'
      produces:
      - application/json
      responses:
        "201":
          description: ok
          schema:
            type: string
        "400":
          description: Некорректный JSON или обязательные поля отсутствуют
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Ошибка сервиса при добавлении пользователя
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Добавление нового пользователя
      tags:
      - users
  /ws:
    get:
      description: |-
        Establishes a WebSocket connection for real-time lecture data streaming.

        Connection flow:
        1. Client opens WebSocket connection to this endpoint.
        2. After connection client sends control messages to manage subscriptions.
        3. Server sends data only for lectures the client is subscribed to.

        Client control messages:
        - Subscribe to lecture: action=subscribe, lecture_id=<lecture identifier>
        - Unsubscribe from lecture: action=unsubscribe, lecture_id=<lecture identifier>

        Subscription rules:
        - One client may subscribe to multiple lectures.
        - Unsubscribed lectures will no longer send data.
        - If the client disconnects, all subscriptions are removed automatically.

        Server messages:
        - Server sends lecture data as JSON messages.
        - Message payload corresponds to data received from RabbitMQ.
        - Exact message schema depends on the physical model and may be extended in the future.

        Future extensions:
        - Additional message types (errors, control events).
        - Extended payload schemas.
      produces:
      - application/json
      responses:
        "101":
          description: Switching Protocols
          schema:
            type: string
      summary: WebSocket connection for lecture streaming
      tags:
      - websocket
swagger: "2.0"
