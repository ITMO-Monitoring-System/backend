basePath: /
definitions:
  auth.LoginRequest:
    properties:
      isu:
        type: string
      password:
        type: string
      role:
        type: string
    type: object
  auth.LoginResponse:
    properties:
      access_token:
        type: string
    type: object
  dataset.DatasetResponse:
    properties:
      users_data:
        items:
          $ref: '#/definitions/dataset.StudentResponse'
        type: array
    type: object
  dataset.StudentResponse:
    properties:
      center_face_embedding:
        items:
          type: number
        type: array
      left_face_embedding:
        items:
          type: number
        type: array
      right_face_embedding:
        items:
          type: number
        type: array
      user_id:
        type: string
    type: object
  department.DepartmentResponse:
    properties:
      alias:
        type: string
      code:
        type: string
      id:
        type: integer
      name:
        type: string
    type: object
  department.ListDepartmentsResponse:
    properties:
      departments:
        items:
          $ref: '#/definitions/department.DepartmentResponse'
        type: array
      has_more:
        type: boolean
    type: object
  group.GroupResponse:
    properties:
      code:
        type: string
      department_id:
        type: integer
    type: object
  lecture.CreateLectureRequest:
    properties:
      date:
        type: string
      group_ids:
        items:
          type: string
        minItems: 1
        type: array
      subject_id:
        type: integer
      teacher_id:
        type: string
    required:
    - date
    - group_ids
    - subject_id
    - teacher_id
    type: object
  lecture.LectureListItemResponse:
    properties:
      date:
        type: string
      id:
        type: integer
      subject_id:
        type: integer
      teacher_id:
        type: string
    type: object
  lecture.LectureResponse:
    properties:
      date:
        type: string
      group_ids:
        items:
          type: string
        type: array
      id:
        type: integer
      subject_id:
        type: integer
      teacher_id:
        type: string
    type: object
  lecture.StartLectureRequest:
    properties:
      lecture_id:
        type: integer
      queue:
        type: string
    type: object
  lecture.StopLectureRequest:
    properties:
      lecture_id:
        type: integer
    type: object
  practice.CreatePracticeRequest:
    properties:
      date:
        type: string
      group_ids:
        items:
          type: string
        minItems: 1
        type: array
      id:
        type: integer
      subject_id:
        type: integer
      teacher_id:
        type: string
    required:
    - date
    - group_ids
    - subject_id
    - teacher_id
    type: object
  practice.PracticeListItemResponse:
    properties:
      date:
        type: string
      id:
        type: integer
      subject_id:
        type: integer
      teacher_id:
        type: string
    type: object
  practice.PracticeResponse:
    properties:
      date:
        type: string
      group_ids:
        items:
          type: string
        type: array
      id:
        type: integer
      subject_id:
        type: integer
      teacher_id:
        type: string
    type: object
  response.ErrorResponse:
    properties:
      error:
        type: string
    type: object
  student_group.ListUsersByGroupResponse:
    properties:
      user_ids:
        items:
          type: string
        type: array
    type: object
  student_group.SetUserGroupRequest:
    properties:
      group_code:
        type: string
      user_id:
        type: string
    required:
    - group_code
    - user_id
    type: object
  student_group.StudentGroupResponse:
    properties:
      group_code:
        type: string
      user_id:
        type: string
    type: object
  subject.CreateSubjectRequest:
    properties:
      id:
        type: integer
      name:
        type: string
    required:
    - name
    type: object
  subject.SubjectResponse:
    properties:
      id:
        type: integer
      name:
        type: string
    type: object
  user.AddUserRequest:
    properties:
      isu:
        type: string
      last_name:
        type: string
      name:
        type: string
      password:
        type: string
      patronymic:
        type: string
    required:
    - isu
    - last_name
    - name
    - password
    type: object
  user.AddUserRoleRequest:
    properties:
      isu:
        type: string
      role:
        type: string
    type: object
  user.GetUserRolesResponse:
    properties:
      isu:
        type: string
      roles:
        items:
          type: string
        type: array
    type: object
  visits.GetStudentLecturesBySubjectResponse:
    properties:
      isu:
        type: string
      items:
        items:
          $ref: '#/definitions/visits.LectureAttendanceItem'
        type: array
      meta:
        $ref: '#/definitions/visits.PageMeta'
      subject_id:
        type: integer
    type: object
  visits.GetVisitedSubjectsResponse:
    properties:
      isu:
        type: string
      subjects:
        items:
          $ref: '#/definitions/visits.SubjectDTO'
        type: array
    type: object
  visits.LectureAttendanceItem:
    properties:
      date:
        description: RFC3339
        type: string
      lecture_id:
        type: integer
      present_seconds:
        type: integer
      teacher_isu:
        type: string
    type: object
  visits.PageMeta:
    properties:
      page:
        type: integer
      page_size:
        type: integer
      total:
        type: integer
    type: object
  visits.SubjectDTO:
    properties:
      id:
        type: integer
      name:
        type: string
    type: object
info:
  contact: {}
  description: Backend for lecture monitoring via RabbitMQ and WebSocket
  title: Monitoring Backend API
  version: "1.0"
paths:
  /api/auth/login:
    post:
      consumes:
      - application/json
      description: Проверяет ISU и пароль, возвращает JWT access token
      parameters:
      - description: Данные для входа
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/auth.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/auth.LoginResponse'
        "400":
          description: Некорректный JSON
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Неверные учетные данные
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Внутренняя ошибка
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Аутентификация пользователя
      tags:
      - auth
  /api/departments:
    get:
      description: Возвращает список департаментов с пагинацией.
      parameters:
      - description: Limit (default 50, max 200)
        in: query
        name: limit
        type: integer
      - description: Offset (default 0)
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/department.ListDepartmentsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: List departments
      tags:
      - departments
  /api/departments/{department_id}/groups:
    get:
      parameters:
      - description: Department ID
        in: path
        name: department_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/group.GroupResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: List groups by department
      tags:
      - groups
  /api/departments/{id}:
    get:
      parameters:
      - description: Department ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/department.DepartmentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Get department by ID
      tags:
      - departments
  /api/departments/code/{code}:
    get:
      parameters:
      - description: Department code
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/department.DepartmentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Get department by code
      tags:
      - departments
  /api/groups/{code}:
    get:
      parameters:
      - description: Group code
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/group.GroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Get group by code
      tags:
      - groups
  /api/groups/{code}/lectures:
    get:
      parameters:
      - description: Group code
        in: path
        name: code
        required: true
        type: string
      - description: RFC3339 start time
        in: query
        name: from
        required: true
        type: string
      - description: RFC3339 end time
        in: query
        name: to
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/lecture.LectureListItemResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: List lectures by group
      tags:
      - lectures
  /api/groups/{code}/practices:
    get:
      parameters:
      - description: Group code
        in: path
        name: code
        required: true
        type: string
      - description: RFC3339 start time
        in: query
        name: from
        required: true
        type: string
      - description: RFC3339 end time
        in: query
        name: to
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/practice.PracticeListItemResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: List practices by group
      tags:
      - practices
  /api/groups/{code}/students:
    get:
      parameters:
      - description: Group code
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/student_group.ListUsersByGroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: List students by group
      tags:
      - student-groups
  /api/health:
    get:
      description: Проверка доступности сервиса
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            type: string
      summary: Health check
      tags:
      - system
  /api/lecture/start:
    post:
      consumes:
      - application/json
      description: Запускает обработку очереди RabbitMQ для лекции
      parameters:
      - description: Lecture and RabbitMQ queue
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/lecture.StartLectureRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Consumer already running
          schema:
            type: string
        "202":
          description: Consumer started
          schema:
            type: string
        "400":
          description: Invalid request body
          schema:
            type: string
      summary: Start lecture processing
      tags:
      - lecture
  /api/lecture/stop:
    post:
      consumes:
      - application/json
      description: Stops RabbitMQ consumer and WebSocket broadcasting for the specified
        lecture.
      parameters:
      - description: Lecture identifier
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/lecture.StopLectureRequest'
      produces:
      - application/json
      responses:
        "200":
          description: ok
          schema:
            type: string
        "400":
          description: Invalid request payload
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Lecture not found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Stop lecture processing
      tags:
      - lecture
  /api/lectures:
    post:
      consumes:
      - application/json
      parameters:
      - description: Lecture payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/lecture.CreateLectureRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/lecture.LectureResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Create lecture
      tags:
      - lectures
  /api/lectures/{id}:
    get:
      parameters:
      - description: Lecture ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/lecture.LectureResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Get lecture by ID
      tags:
      - lectures
  /api/practices:
    post:
      consumes:
      - application/json
      parameters:
      - description: Practice payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/practice.CreatePracticeRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/practice.PracticeResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Create practice
      tags:
      - practices
  /api/practices/{id}:
    get:
      parameters:
      - description: Practice ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/practice.PracticeResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Get practice by ID
      tags:
      - practices
  /api/service/dataset:
    get:
      description: Возвращает список пользователей с эмбеддингами лиц (левый, правый
        и центральный ракурс).
      produces:
      - application/json
      responses:
        "200":
          description: Датасет успешно получен
          schema:
            $ref: '#/definitions/dataset.DatasetResponse'
        "500":
          description: Ошибка при получении датасета
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Получить датасет эмбеддингов лиц
      tags:
      - dataset
  /api/students/{isu}/group:
    delete:
      parameters:
      - description: Student ISU
        in: path
        name: isu
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: ok
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Remove student's group binding
      tags:
      - student-groups
    get:
      parameters:
      - description: Student ISU
        in: path
        name: isu
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/student_group.StudentGroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Get student's group
      tags:
      - student-groups
    put:
      consumes:
      - application/json
      description: Привязывает студента (ISU) к группе. В твоей схеме у студента может
        быть только одна группа.
      parameters:
      - description: Student ISU
        in: path
        name: isu
        required: true
        type: string
      - description: Group binding payload
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/student_group.SetUserGroupRequest'
      produces:
      - application/json
      responses:
        "200":
          description: ok
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Set student's group
      tags:
      - student-groups
  /api/subjects:
    get:
      parameters:
      - description: Limit (default 50, max 200)
        in: query
        name: limit
        type: integer
      - description: Offset (default 0)
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/subject.SubjectResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: List subjects
      tags:
      - subjects
    post:
      consumes:
      - application/json
      parameters:
      - description: Subject payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/subject.CreateSubjectRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/subject.SubjectResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Create subject
      tags:
      - subjects
  /api/subjects/{id}:
    get:
      parameters:
      - description: Subject ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/subject.SubjectResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Get subject by ID
      tags:
      - subjects
  /api/subjects/{id}/lectures:
    get:
      parameters:
      - description: Subject ID
        in: path
        name: id
        required: true
        type: integer
      - description: RFC3339 start time
        in: query
        name: from
        required: true
        type: string
      - description: RFC3339 end time
        in: query
        name: to
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/lecture.LectureListItemResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: List lectures by subject
      tags:
      - lectures
  /api/subjects/{id}/practices:
    get:
      parameters:
      - description: Subject ID
        in: path
        name: id
        required: true
        type: integer
      - description: RFC3339 start time
        in: query
        name: from
        required: true
        type: string
      - description: RFC3339 end time
        in: query
        name: to
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/practice.PracticeListItemResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: List practices by subject
      tags:
      - practices
  /api/subjects/by-name/{name}:
    get:
      parameters:
      - description: Subject name
        in: path
        name: name
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/subject.SubjectResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Get subject by name
      tags:
      - subjects
  /api/teachers/{isu}/lectures:
    get:
      parameters:
      - description: Teacher ISU
        in: path
        name: isu
        required: true
        type: string
      - description: RFC3339 start time
        in: query
        name: from
        required: true
        type: string
      - description: RFC3339 end time
        in: query
        name: to
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/lecture.LectureListItemResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: List lectures by teacher
      tags:
      - lectures
  /api/teachers/{isu}/practices:
    get:
      parameters:
      - description: Teacher ISU
        in: path
        name: isu
        required: true
        type: string
      - description: RFC3339 start time
        in: query
        name: from
        required: true
        type: string
      - description: RFC3339 end time
        in: query
        name: to
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/practice.PracticeListItemResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: List practices by teacher
      tags:
      - practices
  /api/user/admin/create:
    post:
      consumes:
      - application/json
      description: Создаёт нового пользователя с ISU, именем, фамилией и факультативным
        отчеством.
      parameters:
      - description: Bearer <JWT>
        in: header
        name: Authorization
        required: true
        type: string
      - description: Пользователь для добавления
        in: body
        name: user
        required: true
        schema:
          $ref: '#/definitions/user.AddUserRequest'
      produces:
      - application/json
      responses:
        "201":
          description: ok
          schema:
            type: string
        "400":
          description: Некорректный JSON или обязательные поля отсутствуют
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Ошибка сервиса при добавлении пользователя
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Добавление нового пользователя
      tags:
      - users
  /api/user/admin/roles:
    post:
      consumes:
      - application/json
      description: Назначает роль пользователю. Принимает ISU и role в JSON.
      parameters:
      - description: Bearer <JWT>
        in: header
        name: Authorization
        required: true
        type: string
      - description: ISU и роль для добавления
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/user.AddUserRoleRequest'
      produces:
      - application/json
      responses:
        "201":
          description: ok
          schema:
            type: string
        "400":
          description: Некорректный запрос
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Пользователь не найден
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "409":
          description: Роль уже назначена
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Внутренняя ошибка
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Добавить роль пользователю
      tags:
      - users
  /api/user/roles:
    get:
      consumes:
      - application/json
      description: Возвращает список ролей пользователя. ISU передаётся query-параметром
        ?isu=...
      parameters:
      - description: ISU пользователя
        in: query
        name: isu
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/user.GetUserRolesResponse'
        "400":
          description: Некорректный ISU
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Пользователь не найден
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Внутренняя ошибка
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Получить роли пользователя
      tags:
      - users
  /api/user/upload/faces/{isu}:
    post:
      consumes:
      - multipart/form-data
      description: Загружает три фотографии (левая, правая, фронтальная) студента
        и сохраняет их в сервисе.
      parameters:
      - description: ISU студента
        in: path
        name: isu
        required: true
        type: string
      - description: Фотография левой стороны лица
        in: formData
        name: left_face
        required: true
        type: file
      - description: Фотография правой стороны лица
        in: formData
        name: right_face
        required: true
        type: file
      - description: Фотография фронтальной стороны лица
        in: formData
        name: center_face
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: ok
          schema:
            type: string
        "400":
          description: Некорректный ISU или отсутствуют файлы
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Ошибка сервиса при добавлении фотографий
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: Загрузка фотографий лица студента
      tags:
      - users
  /api/visits/lectures/{subject_id}:
    get:
      consumes:
      - application/json
      description: Возвращает лекции по предмету (сортировка по дате) и время присутствия
        студента на каждой лекции (секунды). ISU берётся из JWT.
      parameters:
      - description: ID предмета
        in: path
        name: subject_id
        required: true
        type: integer
      - description: Начало периода (RFC3339 или YYYY-MM-DD)
        in: query
        name: date_from
        type: string
      - description: Конец периода (RFC3339 или YYYY-MM-DD)
        in: query
        name: date_to
        type: string
      - description: 'Сортировка по дате: asc или desc (по умолчанию desc)'
        in: query
        name: order
        type: string
      - description: Страница (по умолчанию 1)
        in: query
        name: page
        type: integer
      - description: Размер страницы (по умолчанию 20)
        in: query
        name: page_size
        type: integer
      - description: Максимальный разрыв между снапшотами для склейки (сек), по умолчанию
          120
        in: query
        name: gap_seconds
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/visits.GetStudentLecturesBySubjectResponse'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Лекции студента по предмету
      tags:
      - visits
  /api/visits/lectures/subjects:
    get:
      consumes:
      - application/json
      description: Возвращает уникальный список предметов (subjects), по которым есть
        записи в visits.lectures_visiting для указанного isu.
      parameters:
      - description: Bearer <JWT>
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/visits.GetVisitedSubjectsResponse'
        "400":
          description: isu is required
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: internal error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Получить предметы, по которым студент посещал лекции
      tags:
      - visits
  /api/ws:
    get:
      description: |-
        Establishes a WebSocket connection for real-time lecture data streaming.

        Connection flow:
        1. Client opens WebSocket connection to this endpoint.
        2. After connection client sends control messages to manage subscriptions.
        3. Server sends data only for lectures the client is subscribed to.

        Client control messages:
        - Subscribe to lecture: action=subscribe, lecture_id=<lecture identifier>
        - Unsubscribe from lecture: action=unsubscribe, lecture_id=<lecture identifier>

        Subscription rules:
        - One client may subscribe to multiple lectures.
        - Unsubscribed lectures will no longer send data.
        - If the client disconnects, all subscriptions are removed automatically.

        Server messages:
        - Server sends lecture data as JSON messages.
        - Message payload corresponds to data received from RabbitMQ.
        - Exact message schema depends on the physical model and may be extended in the future.

        Future extensions:
        - Additional message types (errors, control events).
        - Extended payload schemas.
      produces:
      - application/json
      responses:
        "101":
          description: Switching Protocols
          schema:
            type: string
      summary: WebSocket connection for lecture streaming
      tags:
      - websocket
swagger: "2.0"
